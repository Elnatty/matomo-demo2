<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Matomo Tag Manager – Test Lab</title>

<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="robots" content="noindex, nofollow" />

<!-- Matomo Tag Manager (safe-loaded) -->
<script>
  window._mtm = window._mtm || [];
  _mtm.push({ 'mtm.startTime': Date.now(), 'event': 'mtm.Start' });

  (function () {
    var d = document;
    var g = d.createElement('script');
    var s = d.getElementsByTagName('script')[0];

    g.async = true;
    g.src = 'https://cdn.matomo.cloud/d31ng.matomo.cloud/container_7dc62agp.js';

    g.onload = () => console.log('[Matomo] Container loaded');
    g.onerror = () => console.warn('[Matomo] Container BLOCKED');

    s.parentNode.insertBefore(g, s);
  })();
</script>

<style>
  body {
    font-family: system-ui, sans-serif;
    padding: 40px;
    background: #fafafa;
  }
  button {
    padding: 10px 14px;
    margin: 6px;
  }
  .box {
    background: white;
    border: 1px solid #ddd;
    padding: 20px;
    margin-top: 20px;
  }
  .status {
    padding: 10px;
    background: #eee;
    margin-bottom: 20px;
  }
</style>
  <!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://d31ng.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '4']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='https://cdn.matomo.cloud/d31ng.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->

</head>

<body>

<h1>Matomo Cloud – Bug Bounty Test Site</h1>

<div class="status" id="status">
  Page loaded ✅
</div>

<div class="box">
  <h2>Button Events</h2>
  <button onclick="safePush('simple_click')">Simple Click</button>
  <button onclick="fakePurchase()">Fake Purchase</button>
  <button onclick="adminEvent()">Admin Action</button>
</div>

<div class="box">
  <h2>Form Event</h2>
  <form onsubmit="submitForm(event)">
    <input id="email" type="email" placeholder="test@example.com" required />
    <button type="submit">Submit</button>
  </form>
</div>

<div class="box">
  <h2>DOM & Timing</h2>
  <p id="hover">Hover over this text</p>
  <p id="timer">Timer pending…</p>
</div>

<script>
  function mtmAvailable() {
    return Array.isArray(window._mtm);
  }

  function safePush(eventName, data = {}) {
    if (!mtmAvailable()) {
      console.warn('[MTM] push blocked:', eventName);
      return;
    }
    _mtm.push({ event: eventName, ...data });
    console.log('[MTM] pushed:', eventName);
  }

  function fakePurchase() {
    safePush('purchase', {
      orderId: 'ORDER-' + Math.floor(Math.random() * 10000),
      revenue: 99.99
    });
    alert('Purchase event sent');
  }

  function adminEvent() {
    safePush('admin_action', {
      role: 'admin',
      userId: 1337
    });
    alert('Admin event sent');
  }

  function submitForm(e) {
    e.preventDefault();
    safePush('form_submit', {
      email: document.getElementById('email').value
    });
    alert('Form event sent');
  }

  document.getElementById('hover').addEventListener('mouseover', () => {
    safePush('hover_event');
  });

  setTimeout(() => {
    document.getElementById('timer').innerText = 'Timer fired (10s)';
    safePush('time_on_page', { seconds: 10 });
  }, 10000);
</script>

</body>
</html>
